<!doctype html><html class=no-js lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MW9RRK2');</script><link href="https://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans:300" rel=stylesheet type=text/css><link rel=stylesheet href=https://sysarmy.com/blog//css/style.css><meta charset=utf-8><link rel="shortcut icon" href=https://sysarmy.com/favicon.png><link rel=apple-touch-icon href=https://sysarmy.com/favicon.png><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Probando la API de Twitter: tweet archive y delete"><meta name=keywords content="sysadmin,twitter,api,python,"><meta name=author content="sysarmy"><meta property="fb:admins" content="218813981488432"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@sysarmy"><meta name=twitter:creator content="@sysarmy"><title>Probando la API de Twitter: tweet archive y delete</title><meta property="og:title" content="Probando la API de Twitter: tweet archive y delete"><meta property="twitter:title" content="Probando la API de Twitter: tweet archive y delete"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-10-06"><meta property="og:description" content="Probando la API de Twitter: tweet archive y delete"><meta property="twitter:description" content="Probando la API de Twitter: tweet archive y delete"><meta name=description content="Probando la API de Twitter: tweet archive y delete"><meta property="og:url" content="https://sysarmy.com/blog/posts/api-de-twitter-archive-y-delete/"><meta property="og:site_name" content="sysarmy"><meta property="og:image" content="https://miro.medium.com/max/1400/1*Y5r4YuCqCLqIWlCy_ccPqQ.jpeg"><meta property="twitter:image" content="https://miro.medium.com/max/1400/1*Y5r4YuCqCLqIWlCy_ccPqQ.jpeg"><meta property="og:tags" content="sysadmin"><meta property="og:tags" content="twitter"><meta property="og:tags" content="api"><meta property="og:tags" content="python"><base href=https://sysarmy.com/blog/><link rel=canonical href=https://sysarmy.com/blog/posts/api-de-twitter-archive-y-delete/></head><body lang=en itemscope itemtype=http://schema.org/Article><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9RRK2" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><header id=header><center><a href=https://sysarmy.com/blog/ border=0><img src=https://sysarmy.com/blog//assets/logo.png width=50% height=50%></a></center><nav id=nav>El soporte de quienes dan soporte.
<iframe src=https://open.spotify.com/embed-podcast/show/4aSX6qCCbNLmOUX4fftc5M width=100% height=232 frameborder=0 allowtransparency=true allow=encrypted-media style=margin-left:15px;margin-top:10px></iframe></nav></header><div id=fb-root></div><script async defer crossorigin=anonymous src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v4.0&appId=319096484846369&autoLogAppEvents=1"></script><section id=main><div><h1 itemprop=name id=title>Probando la API de Twitter: tweet archive y delete</h1><article itemprop=articleBody id=content><img src=https://miro.medium.com/max/1400/1*Y5r4YuCqCLqIWlCy_ccPqQ.jpeg alt="Probando la API de Twitter: tweet archive y delete">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin=anonymous><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><p>Hace mucho tiempo que no me ponía a hacer algo con la API de Twitter, y se que hubo muchos cambios en los últimos meses / años en cuanto a funcionalidades, permisos y limitaciones.</p><p>Para este caso en particular necesitaba hacer un cleanup masivo de algunas cuentas de Twitter con decenas de miles de tweets. He aquí algunas cuestiones interesantes, y lecciones aprendidas por pasos para principiantes.</p><h1 id=paso-1-cuenta-dev-de-twitter-permisos-y-autenticación>Paso 1: Cuenta Dev de Twitter, permisos y autenticación</h1><p>Más allá de los pasos para crear la cuenta de Developer de Twitter (y todas las justificaciones necesarias), quiero recalcar un par de tips y problemas que tuve que les pueden llegar a pasar:</p><ol><li>Luego de enviar su request para una cuenta de developer les puede llegar a pasar, como a mí, que en unas pocas horas o días ya van a poder crear su app en el dashboard de Twitter.</li></ol><p><img src=https://miro.medium.com/max/1400/1*Y5r4YuCqCLqIWlCy_ccPqQ.jpeg alt>
<em>Vista principal del dashboard de Twitter Dev</em></p><p>Cuidado, esto es verídico, y por más que creé la app no me funcionaba por problemas de autenticación de tokens (por más que hagan todo bien). Recién un mes después de que me llegó este mail de confirmación pude hacer andar todo. <strong>Clave:</strong> asegurarse de tener la confirmación por mail de Twitter antes de probar porque <strong>no van a poder autenticar</strong>.</p><p><img src=https://miro.medium.com/max/1400/1*JytexSnThIcgvwjzSUWQ7w.jpeg alt></p><p><em>Ejemplo de mail de confirmación</em></p><ol start=2><li>Una vez creada la app, asegúrense de:</li></ol><ul><li>crear un dev environment, agregar la app, y agregar el dev environment a las funcionalidades de la app:
<img src=https://miro.medium.com/max/1400/1*YL4be7SqpYL7t_jXNOFmfA.jpeg alt></li><li>darle los permisos:
<img src=https://miro.medium.com/max/1400/1*7Oj-OPc4a3oCgISwi7WkSg.jpeg alt></li><li>generar y copiar los tokens:
<img src=https://miro.medium.com/max/1400/1*tL8LxVcFxsnjQ1JlPDlzrA.jpeg alt></li><li>suscribir su app a los Labs de Twitter.</li></ul><p>Yo porque soy medio bruto le doy todos los permisos a mi app (por las dudas) pero haciendo esto no tendrían que tener ningun problema. En caso de necesitar troubleshooting de autenticación para los tokens vayan a <a href=https://developer.twitter.com/en/docs/labs/tweets-and-users/quick-start/get-tweets target=_blank>este link</a>
.</p><h1 id=paso-2-script-para-borrar-todos-los-tuits-de-una-cuenta>Paso 2: Script para borrar TODOS los tuits de una cuenta</h1><p>Lamentablemente no hay forma fácil de borrar masivamente tus tuits, y de las herramientas que hay online, una o dos son confiables, pero tenés que pagar. Lo intenté! Pero oh!, el pago es con tarjeta de crédito a través de PayPal, que está bloqueado en el país.</p><p>Lo que hice con este script está basado 90% <a href=https://github.com/ngeor/delete-old-tweets target=_blank>en este código</a>
en Python que encontré en GitHub. Está muy bueno y anda perfecto, gran aporte.</p><p><em>Requerimientos: Python, librería <a href=https://www.tweepy.org/ target=_blank>Tweepy</a>
3.7.0</em></p><ol><li>La autenticación se hace en las primeras líneas sólo con sus Tokens. Es lo único que se usa y no hace falta agregar nada más.</li></ol><p><img src=https://miro.medium.com/max/1214/1*yT_gKrhbYt-E35XmKMrUvA.png alt></p><ol start=2><li><p>Lo único que tienen que hacer es cambiar el max_id con el ID de el tuit que quieren poner como límite y lo que hace el script es borrar todos los tuits empezando por el más viejo. Fácil y simple.</p></li><li><p>Está limitado a 200 API calls por una cuestión obvia. Borra bastante rápido, a un ritmo de medio segundo por tweet, y no te jode con ninguna limitación o threshold de la cuenta de dev.
Ahora&mldr; si están buscando borrar tweets de hasta hace un año, no van a tener problemas. El inconveniente es que cuando hacen el get de los tweets, la API te va a limitar el get tweets hasta un año, siempre. Lamentablemente esta es una limitación a la que no le pudimos encontrar la vuelta.</p></li></ol><h1 id=paso-3-tweet-archive-y-lista-de-ids-de-tweets>Paso 3: Tweet Archive y lista de IDs de Tweets</h1><p>La API nos puede limitar, pero una de las cosas que podemos hacer es — desde los settings de la cuenta — bajar un archive completo de toda tu data de Twitter. Esto te baja absolutamente todo: fotos, actividad, etc. Depende de actividad de la cuenta puede pesar hasta mas de 2 GB:</p><p><img src=https://miro.medium.com/max/1400/1*yzuRuTcX9xhXoQH4rcExtw.png alt></p><ol><li>Una vez bajado el archivo, ir a la carpeta data y editar el archivo tweet.js (va a ser el más pesado de todos). Es un json que se ve así:</li></ol><p><img src=https://miro.medium.com/max/1400/1*Nqkw_1O5MH2rAa1y_rPp-g.png alt></p><p>Va a tener posiblemente miles de lineas y no está ordenado cronológicamente (no pregunten por qué).</p><ol start=2><li>Ahora lo que tenemos que hacer es traernos los IDs de los tweets. Si tienen alguna herramienta para parsear json, bárbaro. Sino lo que pueden hacer es una búsqueda con regex usando notepad++ del campo “id_str”. Este <a href=https://www.launch2success.com/guide/advanced-find-and-replace-in-notepad/ target=_blank>cheatsheet</a>
está bastante simplificado para lo que necesitamos. Una búsqueda así sirve ( <strong>¡cuidado!</strong> algunos IDs tienen 18 dígitos, y otros 19)</li></ol><p><img src=https://miro.medium.com/max/1142/1*F3ambA2C_g0A4b7gIjwYuw.png alt></p><p>Muchos IDs les van a aparecer duplicados, pero lo bueno es que los IDs sí están ordenados numéricamente: ID más bajo es el tweet más viejo y ID más alto es el tweet más nuevo. Removemos duplicados y ordenamos hasta tener una lista en un txt así:</p><p><img src=https://miro.medium.com/max/744/1*-f816Y4PcizjYjPTeLD4xg.png alt></p><ol start=3><li>Una vez que tienen el txt listo: ponen el path en el código (línea 100) y va a buscar los IDs y los va a borrar. Si el ID es viejo de un tuit que ya borraron o no existe, lo omite.
En max_id hay que poner el límite del último tweet que quieren borrar.</li></ol><p><img src=https://miro.medium.com/max/1400/1*BBuNwURXWEhS-oSWkeu9gg.png alt></p><p>Y listo! Si alguien quiere mejorarlo, adelante :) <a href=https://github.com/sysarmy/disneyland/blob/master/misc/api-de-twitter-archive-and-delete/delete_tweets_from_text_file.py target=_blank>Acá está el código listo para usar</a></p><p><em>Créditos a Pablo Pietro, <a href=https://twitter.com/jedux target=_blank>Edu</a>
y <a href=https://twitter.com/godlike64 target=_blank>Godlike</a>
que me dieron una mano pensando e investigando</em></p><h4 id=autor>Autor</h4><p><a href=https://medium.com/@aragunde target=_blank>Mariano Aragunde</a>
Periodista, comunicador, IBMer, ultramaratonista, triatleta, músico, hincha de Racing, del Oeste (con eso creo que alcanza). Mis opiniones son personales</p><div class=ve-desktop><ins class=dcmads style=display:inline-block;width:728px;height:90px data-dcm-placement=N410401.3634809SYSARMY.COMBLOG/B10464038.251052924 data-dcm-rendering-mode=iframe data-dcm-https-only data-dcm-resettable-device-id data-dcm-app-id><script src=https://www.googletagservices.com/dcm/dcmads.js></script></ins></div><div class=ve-mobile><ins class=dcmads style=display:inline-block;width:320px;height:50px data-dcm-placement=N410401.3634809SYSARMY.COMBLOG/B10464038.250920272 data-dcm-rendering-mode=iframe data-dcm-https-only data-dcm-resettable-device-id data-dcm-app-id><script src=https://www.googletagservices.com/dcm/dcmads.js></script></ins></div></article></div></section><aside id=meta><div><section id=datecount><h4 id=date>Tue Oct 6, 2020</h4><h5 id=wc>900 Palabras</h5><h5 id=readtime>Lectura en aprox. 5 Min</h5></section><ul id=tags><li><a href=https://sysarmy.com/blog//tags/sysadmin>sysadmin</a></li><li><a href=https://sysarmy.com/blog//tags/twitter>twitter</a></li><li><a href=https://sysarmy.com/blog//tags/api>api</a></li><li><a href=https://sysarmy.com/blog//tags/python>python</a></li></ul></div><p><h4>Dejanos tu comentario:</h4></p><div id=vanilla-comments></div><script type=text/javascript>var vanilla_forum_url='https://help.sysarmy.com/';var vanilla_identifier="https:\/\/sysarmy.com\/blog\/posts\/api-de-twitter-archive-y-delete\/";var vanilla_title="Probando la API de Twitter: tweet archive y delete";var vanilla_category_id='11';(function(){var vanilla=document.createElement('script');vanilla.type='text/javascript';var timestamp=new Date().getTime();vanilla.src=vanilla_forum_url+'/js/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(vanilla);})();</script><noscript>Please enable JavaScript to view the
<a href=http://vanillaforums.com/?ref_noscript>comments powered by /Help.</a></noscript><div><section id=prev>&nbsp;<a class=previous href=https://sysarmy.com/blog/posts/todavia-se-usan-servers-fisicos/><i class=icon-arrow-left></i> ¿Tu empresa todavía usa servidores físicos? ¿Por qué?</a><br></section><section id=next>&nbsp;<a class=next href=https://sysarmy.com/blog/posts/servicios-de-aws/>Un repaso de los servicios de AWS <i class=icon-arrow-right></i></a></section></div></aside><meta itemprop=wordCount content="867"><meta itemprop=datePublished content="2020-10-06"><meta itemprop=url content="https://sysarmy.com/blog/posts/api-de-twitter-archive-y-delete/"><footer><div><p>&copy; <script>document.write(new Date().getFullYear())</script><span itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>Sysarmy.</span></span> Powered by <a href=http://gohugo.io>Hugo</a> based on <a href=https://spf13.com/>Steve Francia</a> theme.</p></div></footer><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=js/load-photoswipe.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin=anonymous></script></body></html>