<!doctype html><html class=no-js lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MW9RRK2');</script><link href="https://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans:300" rel=stylesheet type=text/css><link rel=stylesheet href=https://sysarmy.com/blog//css/style.css><meta charset=utf-8><link rel="shortcut icon" href=https://sysarmy.com/favicon.png><link rel=apple-touch-icon href=https://sysarmy.com/favicon.png><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Comandos Básicos con Docker - 2da Parte"><meta name=keywords content="containers,docker,dockerhub,linux,"><meta name=author content="sysarmy"><meta property="fb:admins" content="218813981488432"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@sysarmy"><meta name=twitter:creator content="@sysarmy"><title>Comandos Básicos con Docker - 2da Parte</title><meta property="og:title" content="Comandos Básicos con Docker - 2da Parte"><meta property="twitter:title" content="Comandos Básicos con Docker - 2da Parte"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-07-02"><meta property="og:description" content="Comandos Básicos con Docker - 2da Parte"><meta property="twitter:description" content="Comandos Básicos con Docker - 2da Parte"><meta name=description content="Comandos Básicos con Docker - 2da Parte"><meta property="og:url" content="https://sysarmy.com/blog/posts/docker-comandos-basicos-segunda-parte/"><meta property="og:site_name" content="sysarmy"><meta property="og:image" content="assets/docker-thumbnail.png"><meta property="twitter:image" content="assets/docker-thumbnail.png"><meta property="og:tags" content="sysarmy"><meta property="og:tags" content="docker"><meta property="og:tags" content="containers"><meta property="og:tags" content="sistemas"><base href=https://sysarmy.com/blog/><link rel=canonical href=https://sysarmy.com/blog/posts/docker-comandos-basicos-segunda-parte/></head><body lang=en itemscope itemtype=http://schema.org/Article><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9RRK2" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><header id=header><center><a href=https://sysarmy.com/blog/ border=0><img src=https://sysarmy.com/blog//assets/logo.png width=50% height=50%></a></center><nav id=nav>El soporte de quienes dan soporte.
<iframe src=https://open.spotify.com/embed-podcast/show/4aSX6qCCbNLmOUX4fftc5M width=100% height=232 frameborder=0 allowtransparency=true allow=encrypted-media style=margin-left:15px;margin-top:10px></iframe></nav></header><div id=fb-root></div><script async defer crossorigin=anonymous src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v4.0&appId=319096484846369&autoLogAppEvents=1"></script><section id=main><div><h1 itemprop=name id=title>Comandos Básicos con Docker - 2da Parte</h1><article itemprop=articleBody id=content><img src=assets/docker-thumbnail.png alt="Comandos Básicos con Docker - 2da Parte">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin=anonymous><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><p>Además de crear, ejecutar, detener y eliminar contenedores como explicamos en <a href=posts/docker-comandos-basicos-primera-parte>nuestro post previo</a>
hay muchas más operaciones que podemos realizar. Entre ellas se destacan el ver la configuración, darle almacenamiento persistente, e inspeccionar sus logs. En este artículo veremos ejemplos de cada una de estas acciones. Para poder ilustrarlas mejor, crearemos un nuevo contenedor con opciones adicionales.</p><h2 id=comandos-de-administración>Comandos de administración</h2><p>La salida de <code>docker help</code> devuelve dos secciones claramente separadas: <strong>Management Commands</strong> (agrupados por categoría) y la más genérica <strong>Commands</strong> (a secas). Ambos conjuntos nos permiten interactuar con Docker pero hasta este momento hemos utilizado los últimos exclusivamente. Sin embargo, es recomendable acostumbrarnos a utilizar los primeros por una cuestión de consistencia. Veamos la razón.</p><p>En el artículo anterior aprendimos a mostrar la lista de imágenes y contenedores de la siguiente manera:</p><pre><code>docker images
docker ps -a
</code></pre><p>Si bien el primer ejemplo nos da una idea que se refiere a imágenes, no es muy claro qué acción va a realizar. Por otra parte, el último no nos da ninguna pista sobre lo que hace. Sin embargo, al emplear los comandos de administración equivalentes obtenemos el mismo resultado de una forma más fácil de recordar:</p><pre><code>docker image ls
docker container ls -a
</code></pre><p>Estos últimos consisten de <code>docker</code> seguido del tipo de recurso (<code>image</code>, <code>container</code>, etc) y de <code>ls</code> para mostrar la lista. De ahora en adelante, utilizaremos estos comandos siempre que sea posible.</p><h2 id=crear-un-contenedor-con-opciones-adicionales>Crear un contenedor con opciones adicionales</h2><p>Para comenzar, vamos a poner en práctica los comandos de administración empleando la imagen <strong>nginx</strong> para crear un nuevo contenedor. Al mismo tiempo, agregamos dos opciones que van a ser útiles para poder acceder a este.</p><pre><code>docker container run --name=sysarmy-nginx --publish 8080:80 --detach --mount source=sysarmy-webapp,target=/usr/share/nginx/html nginx
</code></pre><p>donde:</p><ul><li><p><code>--publish</code> permite vincular un puerto del host con uno del contenedor. En este caso, con <code>--publish 8080:80</code> se indica que el acceso al puerto 80 de <strong>sysarmy-nginx</strong> se realizará a partir del 8080 en el host. Al poder mapear puertos públicos a otros internos, podemos ejecutar múltiples instancias de nuestra aplicación (o apps distintas) en el mismo host.</p></li><li><p><code>--detach</code> hace que el contenedor se ejecute en segundo plano para poder continuar utilizando la terminal.</p></li><li><p><code>--mount=sysarmy-webapp,target=/usr/share/nginx/html</code> crea un volumen llamado <strong>sysarmy-webapp</strong> en el equipo host y lo monta en <strong>/usr/share/nginx/html</strong> en el contenedor.</p></li></ul><blockquote><p>El <a href=https://docs.docker.com/storage/volumes/ target=_blank>uso de volúmenes</a>
es el método recomendado para implementar almacenamiento persistente ya que es manejado enteramente por Docker. No depende de la estructura de directorios del host.</p></blockquote><p>Dicho de otra manera, el contenedor que acabamos de crear servirá el contenido del volumen <strong>sysarmy-webapp</strong>. Para saber dónde reside ese volumen con el fin de agregar archivos al mismo, podemos usar el comando cuya salida vemos en la imagen siguiente:</p><pre><code>docker volume inspect sysarmy-webapp
</code></pre><p>que indica claramente la acción que nos proponemos llevar a cabo.</p><p><img src=assets/docker-volume-inspect-1.png alt="Inspeccionar volumen utilizado en el contenedor"></p><p>Ahora que sabemos que el volumen está ubicado en <strong>/var/lib/docker/volumes/sysarmy-webapp/_data</strong>, vamos a insertar contenido en el mismo para que el contenedor lo muestre.</p><h2 id=agregar-archivos-en-el-volumen>Agregar archivos en el volumen</h2><p>Como primer paso, añadamos un archivo <strong>index.html</strong> y una copia de la <a href=https://github.com/moby/moby/blob/master/LICENSE target=_blank>licencia Apache 2.0</a>
al volumen:</p><p><img src=assets/docker-agregar-archivos-volumen-1.png alt="Agregar archivos a un volumen"></p><p>Como ejemplo, usamos el siguiente <strong>index.html</strong> básico:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>body</span>&gt;
    &lt;<span style=color:#f92672>h1</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;color: green&#34;</span>&gt;Mi contenedor de nginx&lt;/<span style=color:#f92672>h1</span>&gt;
    &lt;<span style=color:#f92672>p</span>&gt;Descargar una copia de la &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;apache-2.0-license.txt&#34;</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span>&gt;licencia Apache 2.0&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>p</span>&gt;
&lt;/<span style=color:#f92672>body</span>&gt;
</code></pre></div><p>Si ahora abrimos un navegador web y apuntamos a la dirección IP o nombre del host, deberíamos ver la página servida por el contenedor <strong>sysarmy-nginx</strong>:</p><p><img src=assets/docker-nginx-servir-archivos-1.png alt="Comprobar que el contenedor funciona correctamente"></p><p>También podemos ver los logs del contenedor (la opción <code>-f</code> nos permite ver la actividad del log en tiempo real):</p><pre><code>docker container logs sysarmy-nginx -f
</code></pre><p>En la imagen de arriba podemos ver que aparte de nosotros, alguien desde la IP 116.197.128.47 accedió a la raíz del sitio utilizando una versión muy antigua de Google Chrome (¡o quizás también falsearon ese dato, como probablemente lo hicieron con la dirección!). Para quedarnos tranquilos, podemos detener <strong>sysarmy-nginx</strong> por el momento con:</p><pre><code>docker container stop sysarmy-nginx
</code></pre><p>ya que no lo necesitaremos funcionando para la próxima sección.</p><h2 id=ver-la-configuración-del-contenedor>Ver la configuración del contenedor</h2><p>El comando <code>docker container inspect</code>, seguido del nombre del contenedor, nos devuelve información muy detallada sobre el mismo en formato JSON. Para poder consumirla más cómodamente, podemos recurrir a la opción <code>--format</code> e indicar qué sección particular nos interesa. Por ejemplo:</p><pre><code>docker container inspect --format='{{json .State}}' sysarmy-nginx 
docker container inspect --format='{{json .Mounts}}' sysarmy-nginx
</code></pre><p>Aunque la salida de los comandos anteriores no está formateada como acostumbramos ver un archivo <strong>.json</strong>, es más compacta que el resultado de ejecutar <code>docker container inspect</code> sobre el contenedor. Depende de nosotros cuál alternativa usaremos en un momento dado.</p><h2 id=conclusión>Conclusión</h2><p>En este artículo aprendimos a utilizar los comandos de administración de Docker para realizar las tareas que ya conocíamos y otras nuevas. Si nos acostumbramos a emplearlos, nos resultará más fácil identificar qué es lo que cada uno hace con tan solamente mirarlos.</p><div class=ve-desktop><ins class=dcmads style=display:inline-block;width:728px;height:90px data-dcm-placement=N410401.3634809SYSARMY.COMBLOG/B10464038.251052924 data-dcm-rendering-mode=iframe data-dcm-https-only data-dcm-resettable-device-id data-dcm-app-id><script src=https://www.googletagservices.com/dcm/dcmads.js></script></ins></div><div class=ve-mobile><ins class=dcmads style=display:inline-block;width:320px;height:50px data-dcm-placement=N410401.3634809SYSARMY.COMBLOG/B10464038.250920272 data-dcm-rendering-mode=iframe data-dcm-https-only data-dcm-resettable-device-id data-dcm-app-id><script src=https://www.googletagservices.com/dcm/dcmads.js></script></ins></div></article></div></section><aside id=meta><div><section id=datecount><h4 id=date>Thu Jul 2, 2020</h4><h5 id=wc>800 Palabras</h5><h5 id=readtime>Lectura en aprox. 4 Min</h5></section><ul id=tags><li><a href=https://sysarmy.com/blog//tags/sysarmy>sysarmy</a></li><li><a href=https://sysarmy.com/blog//tags/docker>docker</a></li><li><a href=https://sysarmy.com/blog//tags/containers>containers</a></li><li><a href=https://sysarmy.com/blog//tags/sistemas>sistemas</a></li></ul></div><p><h4>Dejanos tu comentario:</h4></p><div id=vanilla-comments></div><script type=text/javascript>var vanilla_forum_url='https://help.sysarmy.com/';var vanilla_identifier="https:\/\/sysarmy.com\/blog\/posts\/docker-comandos-basicos-segunda-parte\/";var vanilla_title="Comandos Básicos con Docker - 2da Parte";var vanilla_category_id='11';(function(){var vanilla=document.createElement('script');vanilla.type='text/javascript';var timestamp=new Date().getTime();vanilla.src=vanilla_forum_url+'/js/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(vanilla);})();</script><noscript>Please enable JavaScript to view the
<a href=http://vanillaforums.com/?ref_noscript>comments powered by /Help.</a></noscript><div><section id=prev>&nbsp;<a class=previous href=https://sysarmy.com/blog/posts/docker-comandos-basicos-primera-parte/><i class=icon-arrow-left></i> Comandos Básicos con Docker - 1era Parte</a><br></section><section id=next>&nbsp;<a class=next href=https://sysarmy.com/blog/posts/polemicaenvar-s04e04-1x-engineers/>Polémica en /var S04E04 - Tips para 1x engineers <i class=icon-arrow-right></i></a></section></div></aside><meta itemprop=wordCount content="791"><meta itemprop=datePublished content="2020-07-02"><meta itemprop=url content="https://sysarmy.com/blog/posts/docker-comandos-basicos-segunda-parte/"><footer><div><p>&copy; <script>document.write(new Date().getFullYear())</script><span itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>Sysarmy.</span></span> Powered by <a href=http://gohugo.io>Hugo</a> based on <a href=https://spf13.com/>Steve Francia</a> theme.</p></div></footer><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=js/load-photoswipe.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin=anonymous></script></body></html>